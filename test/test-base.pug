extends base

block style
	link(rel='stylesheet', href='/fonts/iconmonstr/iconmonstr-iconic-font.css')
	style
		:sass
			pre.console
				font-family: monospace
				line-height: 1.3em
				tab-size: 4

				div + div
					--margin: 8px
					margin-top: var(--margin)
					padding-top: var(--margin)
					border-top: 1px solid #eee

				.comment
					color: #999

				.title
					padding-bottom: 8px
					font-size: 2.5em

				.info span
					display: inline-block
					padding: 1px 2px 3px 2px
					background-color: #eee
					color: #139A71

				div + div.title
					margin-top: 128px
					border-top: none

				.log:before
					content: '> '

				.assert

					&:before
						position: relative
						display: inline-block
						font-family: 'iconmonstr-iconic-font'
						font-size: .9em
						padding-right: 8px
						transform: translateY(.25em)
					
					&.success
						color: #139A71
						
						&:before
							content: '\e0f1'

					&.fail
						color: #E7100C

						&:before
							content: '\e0f5'

block body

	pre.console

	script.

		function log(...args) {

			if (log.toConsole)
				console.log.apply(console, args)

			let div = document.createElement('div')
			div.classList.add('log')

			log.last = 
			div.innerHTML = args.join(' ')

			document.querySelector('.console').appendChild(div)

		}

		log.toConsole = true



		log.getLog = function(index) {

			let children = document.querySelector('.console').querySelectorAll('.log')

			if (index < 0)
				index += children.length

			return children[index].innerHTML

		}

		log.getLogs = function(fromIndex, toIndex) {

			let children = [...document.querySelector('.console').querySelectorAll('.log')]

			return children.slice(fromIndex, toIndex).map(div => div.innerHTML)

		}





		function getLogDiv(type, msg) {

			let div = document.createElement('div')
			div.classList.add(type)
			div.innerHTML = `<span>${msg}</span>`

			document.querySelector('.console').appendChild(div)

		}

		log.comment = msg => getLogDiv('comment', msg)
		log.info = msg => getLogDiv('info', msg)
		log.title = msg => getLogDiv('title', msg)





		log.assert = function assert(msg, test) {

			let div = document.createElement('div')
			div.classList.add('assert')

			div.classList.add(test ? 'success' : 'fail')
			div.innerHTML = (test ? '' : 'fail: ') + msg

			document.querySelector('.console').appendChild(div)

		}
